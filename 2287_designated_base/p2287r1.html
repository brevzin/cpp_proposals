<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="mpark/wg21" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2021-02-14" />
  <title>Designated-initializers for Base Classes</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f6f8fa; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span. { } /* Normal */
      code span.al { color: #ff0000; } /* Alert */
      code span.an { } /* Annotation */
      code span.at { } /* Attribute */
      code span.bn { color: #9f6807; } /* BaseN */
      code span.bu { color: #9f6807; } /* BuiltIn */
      code span.cf { color: #00607c; } /* ControlFlow */
      code span.ch { color: #9f6807; } /* Char */
      code span.cn { } /* Constant */
      code span.co { color: #008000; font-style: italic; } /* Comment */
      code span.cv { color: #008000; font-style: italic; } /* CommentVar */
      code span.do { color: #008000; } /* Documentation */
      code span.dt { color: #00607c; } /* DataType */
      code span.dv { color: #9f6807; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #9f6807; } /* Float */
      code span.fu { } /* Function */
      code span.im { } /* Import */
      code span.in { color: #008000; } /* Information */
      code span.kw { color: #00607c; } /* Keyword */
      code span.op { color: #af1915; } /* Operator */
      code span.ot { } /* Other */
      code span.pp { color: #6f4e37; } /* Preprocessor */
      code span.re { } /* RegionMarker */
      code span.sc { color: #9f6807; } /* SpecialChar */
      code span.ss { color: #9f6807; } /* SpecialString */
      code span.st { color: #9f6807; } /* String */
      code span.va { } /* Variable */
      code span.vs { color: #9f6807; } /* VerbatimString */
      code span.wa { color: #008000; font-weight: bold; } /* Warning */
      code.diff {color: #898887}
      code.diff span.va {color: #006e28}
      code.diff span.st {color: #bf0303}
  </style>
  <style type="text/css">
body {
margin: 5em;
font-family: serif;

hyphens: auto;
line-height: 1.35;
}
div.wrapper {
max-width: 60em;
margin: auto;
}
ul {
list-style-type: none;
padding-left: 2em;
margin-top: -0.2em;
margin-bottom: -0.2em;
}
a {
text-decoration: none;
color: #4183C4;
}
a.hidden_link {
text-decoration: none;
color: inherit;
}
li {
margin-top: 0.6em;
margin-bottom: 0.6em;
}
h1, h2, h3, h4 {
position: relative;
line-height: 1;
}
a.self-link {
position: absolute;
top: 0;
left: calc(-1 * (3.5rem - 26px));
width: calc(3.5rem - 26px);
height: 2em;
text-align: center;
border: none;
transition: opacity .2s;
opacity: .5;
font-family: sans-serif;
font-weight: normal;
font-size: 83%;
}
a.self-link:hover { opacity: 1; }
a.self-link::before { content: "§"; }
ul > li:before {
content: "\2014";
position: absolute;
margin-left: -1.5em;
}
:target { background-color: #C9FBC9; }
:target .codeblock { background-color: #C9FBC9; }
:target ul { background-color: #C9FBC9; }
.abbr_ref { float: right; }
.folded_abbr_ref { float: right; }
:target .folded_abbr_ref { display: none; }
:target .unfolded_abbr_ref { float: right; display: inherit; }
.unfolded_abbr_ref { display: none; }
.secnum { display: inline-block; min-width: 35pt; }
.header-section-number { display: inline-block; min-width: 35pt; }
.annexnum { display: block; }
div.sourceLinkParent {
float: right;
}
a.sourceLink {
position: absolute;
opacity: 0;
margin-left: 10pt;
}
a.sourceLink:hover {
opacity: 1;
}
a.itemDeclLink {
position: absolute;
font-size: 75%;
text-align: right;
width: 5em;
opacity: 0;
}
a.itemDeclLink:hover { opacity: 1; }
span.marginalizedparent {
position: relative;
left: -5em;
}
li span.marginalizedparent { left: -7em; }
li ul > li span.marginalizedparent { left: -9em; }
li ul > li ul > li span.marginalizedparent { left: -11em; }
li ul > li ul > li ul > li span.marginalizedparent { left: -13em; }
div.footnoteNumberParent {
position: relative;
left: -4.7em;
}
a.marginalized {
position: absolute;
font-size: 75%;
text-align: right;
width: 5em;
}
a.enumerated_item_num {
position: relative;
left: -3.5em;
display: inline-block;
margin-right: -3em;
text-align: right;
width: 3em;
}
div.para { margin-bottom: 0.6em; margin-top: 0.6em; text-align: justify; }
div.section { text-align: justify; }
div.sentence { display: inline; }
span.indexparent {
display: inline;
position: relative;
float: right;
right: -1em;
}
a.index {
position: absolute;
display: none;
}
a.index:before { content: "⟵"; }

a.index:target {
display: inline;
}
.indexitems {
margin-left: 2em;
text-indent: -2em;
}
div.itemdescr {
margin-left: 3em;
}
.bnf {
font-family: serif;
margin-left: 40pt;
margin-top: 0.5em;
margin-bottom: 0.5em;
}
.ncbnf {
font-family: serif;
margin-top: 0.5em;
margin-bottom: 0.5em;
margin-left: 40pt;
}
.ncsimplebnf {
font-family: serif;
font-style: italic;
margin-top: 0.5em;
margin-bottom: 0.5em;
margin-left: 40pt;
background: inherit; 
}
span.textnormal {
font-style: normal;
font-family: serif;
white-space: normal;
display: inline-block;
}
span.rlap {
display: inline-block;
width: 0px;
}
span.descr { font-style: normal; font-family: serif; }
span.grammarterm { font-style: italic; }
span.term { font-style: italic; }
span.terminal { font-family: monospace; font-style: normal; }
span.nonterminal { font-style: italic; }
span.tcode { font-family: monospace; font-style: normal; }
span.textbf { font-weight: bold; }
span.textsc { font-variant: small-caps; }
a.nontermdef { font-style: italic; font-family: serif; }
span.emph { font-style: italic; }
span.techterm { font-style: italic; }
span.mathit { font-style: italic; }
span.mathsf { font-family: sans-serif; }
span.mathrm { font-family: serif; font-style: normal; }
span.textrm { font-family: serif; }
span.textsl { font-style: italic; }
span.mathtt { font-family: monospace; font-style: normal; }
span.mbox { font-family: serif; font-style: normal; }
span.ungap { display: inline-block; width: 2pt; }
span.textit { font-style: italic; }
span.texttt { font-family: monospace; }
span.tcode_in_codeblock { font-family: monospace; font-style: normal; }
span.phantom { color: white; }

span.math { font-style: normal; }
span.mathblock {
display: block;
margin-left: auto;
margin-right: auto;
margin-top: 1.2em;
margin-bottom: 1.2em;
text-align: center;
}
span.mathalpha {
font-style: italic;
}
span.synopsis {
font-weight: bold;
margin-top: 0.5em;
display: block;
}
span.definition {
font-weight: bold;
display: block;
}
.codeblock {
margin-left: 1.2em;
line-height: 127%;
}
.outputblock {
margin-left: 1.2em;
line-height: 127%;
}
div.itemdecl {
margin-top: 2ex;
}
code.itemdeclcode {
white-space: pre;
display: block;
}
span.textsuperscript {
vertical-align: super;
font-size: smaller;
line-height: 0;
}
.footnotenum { vertical-align: super; font-size: smaller; line-height: 0; }
.footnote {
font-size: small;
margin-left: 2em;
margin-right: 2em;
margin-top: 0.6em;
margin-bottom: 0.6em;
}
div.minipage {
display: inline-block;
margin-right: 3em;
}
div.numberedTable {
text-align: center;
margin: 2em;
}
div.figure {
text-align: center;
margin: 2em;
}
table {
border: 1px solid black;
border-collapse: collapse;
margin-left: auto;
margin-right: auto;
margin-top: 0.8em;
text-align: left;
hyphens: none; 
}
td, th {
padding-left: 1em;
padding-right: 1em;
vertical-align: top;
}
td.empty {
padding: 0px;
padding-left: 1px;
}
td.left {
text-align: left;
}
td.right {
text-align: right;
}
td.center {
text-align: center;
}
td.justify {
text-align: justify;
}
td.border {
border-left: 1px solid black;
}
tr.rowsep, td.cline {
border-top: 1px solid black;
}
tr.even, tr.odd {
border-bottom: 1px solid black;
}
tr.capsep {
border-top: 3px solid black;
border-top-style: double;
}
tr.header {
border-bottom: 3px solid black;
border-bottom-style: double;
}
th {
border-bottom: 1px solid black;
}
span.centry {
font-weight: bold;
}
div.table {
display: block;
margin-left: auto;
margin-right: auto;
text-align: center;
width: 90%;
}
span.indented {
display: block;
margin-left: 2em;
margin-bottom: 1em;
margin-top: 1em;
}
ol.enumeratea { list-style-type: none; background: inherit; }
ol.enumerate { list-style-type: none; background: inherit; }

code.sourceCode > span { display: inline; }
</style>
  <style type="text/css">a {
color : #4183C4;
text-decoration: underline;
}
a.marginalized {
text-decoration: none;
}
a.self-link {
text-decoration: none;
}
h1#toctitle {
border-bottom: 1px solid #cccccc;
}
#TOC li {
margin-top: 1px;
margin-bottom: 1px;
}
#TOC ul>li:before { display: none; }
h3.subtitle { margin-top: -15px; }
h1:target { background-color: transparent; }
h2:target { background-color: transparent; }
h3:target { background-color: transparent; }
h4:target { background-color: transparent; }
h5:target { background-color: transparent; }
h6:target { background-color: transparent; }
code span.co { font-family: monospace; }
table tr {
background-color: white;
}
table tr:nth-child(2n) {
background-color: #f6f8fa;
}
#title-block-header > table tr:nth-child(2n) {
background-color: white;
}
td > div.sourceCode {
background-color: inherit;
}
table {
border-collapse: collapse;
}
table td, table th {
border: 1px solid #cccccc;
}
table th {
border-bottom: 1px solid black;
text-align: center;
}
table tr:first-child th {
border-top: 0;
}
table tr:last-child td {
border-bottom: 0;
}
table tr td:first-child,
table tr th:first-child {
border-left: 0;
}
table tr td:last-child,
table tr th:last-child {
border-right: 0;
}
table tbody tr:first-child td {
border-top: 1px solid black;
}
#title-block-header td { border: 0; }
@media all {
body {
margin: 2em;
}
}
@media screen and (min-width: 480px) {
body {
margin: 5em;
}
}
#refs code{padding-left: 0px; text-indent: 0px;}
:root {
--diff-ins: #e6ffed;
--diff-strongins: #acf2bd;
--diff-del: #ffdddd;
--diff-strongdel: #ff8888;
}
span.diffins {
background-color: var(--diff-strongins);
}
span.diffdel {
background-color: var(--diff-strongdel);
}
div.rm { text-decoration: line-through; }
div.rm code.sourceCode { text-decoration: line-through; }
div.addu, span.addu {
color: #006e28;
background-color: var(--diff-ins);
}

div.rm pre, div.add pre { background-color: #f6f8fa; }
div.addu pre { background-color: var(--diff-ins); }
div.add, div.add pre { background-color: var(--diff-ins); }
div.addu blockquote {
border-left: 4px solid #00a000;
padding: 0 15px;
color: #006e28;
text-decoration: none;
}
div.addu blockquote code.sourceCode { text-decoration: none; }
div.addu blockquote pre { text-decoration: none; }
div.addu blockquote pre code { text-decoration: none; }
div.quote {
border-left: 7px solid #ccc;
background: #f9f9f9;
margin: 1.5em 10px;
padding-left: 20px;
}
code.diff span.va { color: #000000; background-color: var(--diff-ins); }
code.diff span.st { color: #000000; background-color: var(--diff-del); }
</style>
  <link href="data:image/x-icon;base64,AAABAAIAEBAAAAEAIABoBAAAJgAAACAgAAABACAAqBAAAI4EAAAoAAAAEAAAACAAAAABACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAVoJEAN6CRADegkQAWIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wCCRAAAgkQAAIJEAACCRAAsgkQAvoJEAP+CRAD/gkQA/4JEAP+CRADAgkQALoJEAACCRAAAgkQAAP///wD///8AgkQAAIJEABSCRACSgkQA/IJEAP99PQD/dzMA/3czAP99PQD/gkQA/4JEAPyCRACUgkQAFIJEAAD///8A////AHw+AFiBQwDqgkQA/4BBAP9/PxP/uZd6/9rJtf/bybX/upd7/39AFP+AQQD/gkQA/4FDAOqAQgBc////AP///wDKklv4jlEa/3o7AP+PWC//8+3o///////////////////////z7un/kFox/35AAP+GRwD/mVYA+v///wD///8A0Zpk+NmibP+0d0T/8evj///////+/fv/1sKz/9bCs//9/fr//////+/m2/+NRwL/nloA/5xYAPj///8A////ANKaZPjRmGH/5cKh////////////k149/3UwAP91MQD/lmQ//86rhv+USg3/m1YA/5hSAP+bVgD4////AP///wDSmmT4zpJY/+/bx///////8+TV/8mLT/+TVx//gkIA/5lVAP+VTAD/x6B//7aEVv/JpH7/s39J+P///wD///8A0ppk+M6SWP/u2sf///////Pj1f/Nj1T/2KFs/8mOUv+eWhD/lEsA/8aee/+0glT/x6F7/7J8Rvj///8A////ANKaZPjRmGH/48Cf///////+/v7/2qt//82PVP/OkFX/37KJ/86siv+USg7/mVQA/5hRAP+bVgD4////AP///wDSmmT40ppk/9CVXP/69O////////7+/v/x4M//8d/P//7+/f//////9u7n/6tnJf+XUgD/nFgA+P///wD///8A0ppk+NKaZP/RmWL/1qNy//r07///////////////////////+vXw/9akdP/Wnmn/y5FY/6JfFvj///8A////ANKaZFTSmmTo0ppk/9GYYv/Ql1//5cWm//Hg0P/x4ND/5cWm/9GXYP/RmGH/0ppk/9KaZOjVnmpY////AP///wDSmmQA0ppkEtKaZI7SmmT60ppk/9CWX//OkVb/zpFW/9CWX//SmmT/0ppk/NKaZJDSmmQS0ppkAP///wD///8A0ppkANKaZADSmmQA0ppkKtKaZLrSmmT/0ppk/9KaZP/SmmT/0ppkvNKaZCrSmmQA0ppkANKaZAD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkUtKaZNzSmmTc0ppkVNKaZADSmmQA0ppkANKaZADSmmQA////AP5/AAD4HwAA4AcAAMADAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAMADAADgBwAA+B8AAP5/AAAoAAAAIAAAAEAAAAABACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///wCCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAAyCRACMgkQA6oJEAOqCRACQgkQAEIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wD///8A////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRABigkQA5oJEAP+CRAD/gkQA/4JEAP+CRADqgkQAZoJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAAD///8A////AP///wD///8AgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAA4gkQAwoJEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQAxIJEADyCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAAgkQAAP///wD///8A////AP///wCCRAAAgkQAAIJEAACCRAAAgkQAAIJEAACCRAAWgkQAmIJEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAJyCRAAYgkQAAIJEAACCRAAAgkQAAIJEAACCRAAA////AP///wD///8A////AIJEAACCRAAAgkQAAIJEAACCRAAAgkQAdIJEAPCCRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAP+CRAD/gkQA/4JEAPSCRAB4gkQAAIJEAACCRAAAgkQAAIJEAAD///8A////AP///wD///8AgkQAAIJEAACCRAAAgkQASoJEANKCRAD/gkQA/4JEAP+CRAD/g0YA/39AAP9zLgD/bSQA/2shAP9rIQD/bSQA/3MuAP9/PwD/g0YA/4JEAP+CRAD/gkQA/4JEAP+CRADUgkQAToJEAACCRAAAgkQAAP///wD///8A////AP///wB+PwAAgkUAIoJEAKiCRAD/gkQA/4JEAP+CRAD/hEcA/4BBAP9sIwD/dTAA/5RfKv+viF7/vp56/76ee/+wiF7/lWAr/3YxAP9sIwD/f0AA/4RHAP+CRAD/gkQA/4JEAP+CRAD/gkQArIJEACaBQwAA////AP///wD///8A////AIBCAEBzNAD6f0EA/4NFAP+CRAD/gkQA/4VIAP92MwD/bSUA/6N1Tv/ezsL/////////////////////////////////38/D/6V3Uv9uJgD/dTEA/4VJAP+CRAD/gkQA/4JEAP+BQwD/fUAA/4FDAEj///8A////AP///wD///8AzJRd5qBlKf91NgD/dDUA/4JEAP+FSQD/cy4A/3YyAP/PuKP//////////////////////////////////////////////////////9K7qP94NQD/ciwA/4VJAP+CRAD/fkEA/35BAP+LSwD/mlYA6v///wD///8A////AP///wDdpnL/4qx3/8KJUv+PUhf/cTMA/3AsAP90LgD/4dK+/////////////////////////////////////////////////////////////////+TYxf91MAD/dTIA/31CAP+GRwD/llQA/6FcAP+gWwD8////AP///wD///8A////ANGZY/LSm2X/4ap3/92mcP+wdT3/byQA/8mwj////////////////////////////////////////////////////////////////////////////+LYxv9zLgP/jUoA/59bAP+hXAD/nFgA/5xYAPL///8A////AP///wD///8A0ppk8tKaZP/RmWL/1p9q/9ubXv/XqXj////////////////////////////7+fD/vZyG/6BxS/+gcUr/vJuE//r37f//////////////////////3MOr/5dQBf+dVQD/nVkA/5xYAP+cWAD/nFgA8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/SmWP/yohJ//jo2P//////////////////////4NTG/4JDFf9lGAD/bSQA/20kAP9kGAD/fz8S/+Xb0f//////5NG9/6txN/+LOgD/m1QA/51aAP+cWAD/m1cA/5xYAP+cWADy////AP///wD///8A////ANKaZPLSmmT/0ppk/8+TWf/Unmv//v37//////////////////////+TWRr/VwsA/35AAP+ERgD/g0UA/4JGAP9lHgD/kFga/8KXX/+TRwD/jT4A/49CAP+VTQD/n10A/5xYAP+OQQD/lk4A/55cAPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/y4tO/92yiP//////////////////////8NnE/8eCQP+rcTT/ez0A/3IyAP98PgD/gEMA/5FSAP+USwD/jj8A/5lUAP+JNwD/yqV2/694Mf+HNQD/jkAA/82rf/+laBj/jT4A8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/LiUr/4byY///////////////////////gupX/0I5P/+Wuev/Lklz/l1sj/308AP+QSwD/ol0A/59aAP+aVQD/k0oA/8yoh///////+fXv/6pwO//Lp3v///////Pr4f+oay7y////AP///wD///8A////ANKaZPLSmmT/0ppk/8uJSv/hvJj//////////////////////+G7l//Jhkb/0ppk/96nc//fqXX/x4xO/6dkFP+QSQD/llEA/5xXAP+USgD/yaOA///////38uv/qG05/8ijdv//////8efb/6ZpLPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/zIxO/9yxh///////////////////////7dbA/8iEQf/Sm2X/0Zlj/9ScZv/eqHf/2KJv/7yAQf+XTgD/iToA/5lSAP+JNgD/yKFv/611LP+HNQD/jT8A/8qmeP+kZRT/jT4A8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/Pk1n/1J5q//78+//////////////////+/fv/1aFv/8iEQv/Tm2b/0ppl/9GZY//Wn2z/1pZc/9eldf/Bl2b/kUcA/4w9AP+OQAD/lUwA/59eAP+cWQD/jT8A/5ZOAP+eXADy////AP///wD///8A////ANKaZPLSmmT/0ppk/9KZY//KiEn/8d/P///////////////////////47+f/05tm/8iCP//KiEj/yohJ/8eCP//RmGH//vfy///////n1sP/rXQ7/4k4AP+TTAD/nVoA/5xYAP+cVwD/nFgA/5xYAPL///8A////AP///wD///8A0ppk8tKaZP/SmmT/0ptl/8uLTf/aq37////////////////////////////+/fz/6c2y/961jv/etY7/6Myx//78+v//////////////////////3MWv/5xXD/+ORAD/mFQA/51ZAP+cWAD/nFgA8v///wD///8A////AP///wDSmmTy0ppk/9KaZP/SmmT/0ppk/8mFRP/s1b//////////////////////////////////////////////////////////////////////////////+PD/0JFU/7NzMv+WUQD/kUsA/5tXAP+dWQDy////AP///wD///8A////ANKaZP/SmmT/0ppk/9KaZP/Sm2X/z5NZ/8yMT//z5NX/////////////////////////////////////////////////////////////////9Ofa/8yNUP/UmGH/36p5/8yTWv+qaSD/kksA/5ROAPz///8A////AP///wD///8A0ppk5NKaZP/SmmT/0ppk/9KaZP/TnGf/zY9T/82OUv/t1sD//////////////////////////////////////////////////////+7Yw//OkFX/zI5R/9OcZ//SmmP/26V0/9ymdf/BhUf/ol8R6P///wD///8A////AP///wDSmmQ80ppk9tKaZP/SmmT/0ppk/9KaZP/TnGj/zpFW/8qJSv/dson/8uHS//////////////////////////////////Lj0//etIv/y4lL/86QVf/TnGj/0ppk/9KaZP/RmWP/05xn/9ymdfjUnWdC////AP///wD///8A////ANKaZADSmmQc0ppkotKaZP/SmmT/0ppk/9KaZP/Tm2b/0Zli/8qJSf/NjlH/16Z3/+G8mP/myKr/5siq/+G8mP/Xp3f/zY5S/8qISf/RmGH/05tm/9KaZP/SmmT/0ppk/9KaZP/SmmSm0pljINWdaQD///8A////AP///wD///8A0ppkANKaZADSmmQA0ppkQtKaZMrSmmT/0ppk/9KaZP/SmmT/0ptl/9GYYf/Nj1P/y4lL/8qISP/KiEj/y4lK/82PU//RmGH/0ptl/9KaZP/SmmT/0ppk/9KaZP/SmmTO0ppkRtKaZADSmmQA0ppkAP///wD///8A////AP///wDSmmQA0ppkANKaZADSmmQA0ppkANKaZGzSmmTu0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmTw0ppkcNKaZADSmmQA0ppkANKaZADSmmQA////AP///wD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZBLSmmSQ0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppklNKaZBTSmmQA0ppkANKaZADSmmQA0ppkANKaZAD///8A////AP///wD///8A0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQy0ppkutKaZP/SmmT/0ppk/9KaZP/SmmT/0ppk/9KaZP/SmmT/0ppkvtKaZDbSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkAP///wD///8A////AP///wDSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkXNKaZODSmmT/0ppk/9KaZP/SmmT/0ppk5NKaZGDSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA////AP///wD///8A////ANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkBtKaZIbSmmTo0ppk6tKaZIrSmmQK0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZADSmmQA0ppkANKaZAD///8A////AP/8P///+B///+AH//+AAf//AAD//AAAP/AAAA/gAAAHwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA+AAAAfwAAAP/AAAP/8AAP//gAH//+AH///4H////D//" rel="icon" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  
</head>
<body>
<div class="wrapper">
<header id="title-block-header">
<h1 class="title" style="text-align:center">Designated-initializers for Base Classes</h1>

<table style="border:none;float:right">
  <tr>
    <td>Document #:</td>
    <td>P2287R1</td>
  </tr>
  <tr>
    <td>Date:</td>
    <td>2021-02-14</td>
  </tr>
  <tr>
    <td style="vertical-align:top">Project:</td>
    <td>Programming Language C++</td>
  </tr>
  <tr>
    <td style="vertical-align:top">Audience:</td>
    <td>
      EWG<br>
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top">Reply-to:</td>
    <td>
      Barry Revzin<br>&lt;<a href="mailto:barry.revzin@gmail.com" class="email">barry.revzin@gmail.com</a>&gt;<br>
    </td>
  </tr>
</table>

</header>
<div style="clear:both">
<div id="TOC" role="doc-toc">
<h1 id="toctitle">Contents</h1>
<ul>
<li><a href="#revision-history"><span class="toc-section-number">1</span> Revision History<span></span></a></li>
<li><a href="#introduction"><span class="toc-section-number">2</span> Introduction<span></span></a></li>
<li><a href="#proposal"><span class="toc-section-number">3</span> Proposal<span></span></a>
<ul>
<li><a href="#directly-name-base-class-members"><span class="toc-section-number">3.1</span> Directly name base-class members<span></span></a></li>
<li><a href="#lookup-of-base-classes"><span class="toc-section-number">3.2</span> Lookup of base classes<span></span></a></li>
</ul></li>
<li><a href="#wording"><span class="toc-section-number">4</span> Wording<span></span></a></li>
<li><a href="#bibliography"><span class="toc-section-number">5</span> References<span></span></a></li>
</ul>
</div>
<h1 data-number="1" style="border-bottom:1px solid #cccccc" id="revision-history"><span class="header-section-number">1</span> Revision History<a href="#revision-history" class="self-link"></a></h1>
<p><span class="citation" data-cites="P2287R0">[<a href="#ref-P2287R0" role="doc-biblioref">P2287R0</a>]</span> proposed a single syntax for a <em>designated-initializer</em> that identifies a base class. Based on a reflector suggestion from Matthias Stearn, this revision extends the syntax to allow the brace-elision version of <em>designated-initializer</em>: allow naming indirect non-static data members as well. Also actually correctly targeting EWG this time.</p>
<h1 data-number="2" style="border-bottom:1px solid #cccccc" id="introduction"><span class="header-section-number">2</span> Introduction<a href="#introduction" class="self-link"></a></h1>
<p><span class="citation" data-cites="P0017R1">[<a href="#ref-P0017R1" role="doc-biblioref">P0017R1</a>]</span> extended aggregates to allow an aggregate to have a base class. <span class="citation" data-cites="P0329R4">[<a href="#ref-P0329R4" role="doc-biblioref">P0329R4</a>]</span> gave us designated initializers, which allow for much more expressive and functional initialization of aggregates. However, the two do not mix: a designated initializer can currently only refer to a direct non-static data members. This means that if I have a type like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">struct</span> A <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="dt">int</span> a;</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="op">}</span>;</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">struct</span> B <span class="op">:</span> A <span class="op">{</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="dt">int</span> b;</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="op">}</span>;</span></code></pre></div>
<p>While I can initialize an <code class="sourceCode cpp">A</code> like <code class="sourceCode cpp">A<span class="op">{.</span>a<span class="op">=</span><span class="dv">1</span><span class="op">}</span></code>, I cannot designated-initialize <code class="sourceCode cpp">B</code>. An attempt like <code class="sourceCode cpp">B<span class="op">{</span>{1}, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span></code> runs afoul of the rule that the initializers must either be all designated or none designated. But there is currently no way to designate the base class here.</p>
<p>Which means that my only options for initializing a <code class="sourceCode cpp">B</code> are to fall-back to regular aggregate initialization and write either <code class="sourceCode cpp">B<span class="op">{</span>{1}, <span class="dv">2</span><span class="op">}</span></code> or <code class="sourceCode cpp">B<span class="op">{</span><span class="dv">1</span>, <span class="dv">2</span><span class="op">}</span></code>. Neither are especially satisfactory.</p>
<p>The goal of this paper is to extend designated initialization to include base classes and base class members.</p>
<h1 data-number="3" style="border-bottom:1px solid #cccccc" id="proposal"><span class="header-section-number">3</span> Proposal<a href="#proposal" class="self-link"></a></h1>
<p>The tricky part here is: how do we name the <code class="sourceCode cpp">A</code> base class of <code class="sourceCode cpp">B</code> in the <em>designated-initializer-list</em>? While non-static data members have <em>identifier</em>s, base classes can be much more complicated. They can be qualified names, they can have template arguments, etc. We also do not actually have a way to name the <code class="sourceCode cpp">A</code> base class subobject of a <code class="sourceCode cpp">B</code> today — the only way to get there is via a cast. This means there’s no corresponding consistent syntax to choose along with the <code class="sourceCode cpp"><span class="op">.</span></code> that we already have.</p>
<p>Daveed Vandevoorde makes the suggestion that we can use <code class="sourceCode cpp"><span class="op">:</span></code> to introduce a <em>class-or-decltype</em> that names a base class (that is the grammar term we use when introducing a base class). This would allow the following initialization syntax:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1"></a>B<span class="op">{:</span>A<span class="op">={.</span>a<span class="op">=</span><span class="dv">1</span><span class="op">}</span>, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span></span></code></pre></div>
<p>Using a <code class="sourceCode cpp"><span class="op">:</span></code> mimics the way we introduce base classes in class directions and is otherwise unambiguous with the rest of the <em>designated-initializer</em> syntax. It can also prepare the parser for the fact that a more complicated name might be coming.</p>
<p>This paper does not change any of the other existing designated-initialization rules: the initializers must still be all designated or none designated, and the designators must be in order. I’m simply extending the order being matched against with all the base classes. That is, while <code class="sourceCode cpp">B<span class="op">{:</span>A<span class="op">={.</span>a<span class="op">=</span><span class="dv">1</span><span class="op">}</span>, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span></code> would be a valid way to initialize a <code class="sourceCode cpp">B</code>, <code class="sourceCode cpp">B<span class="op">{.</span>b<span class="op">=</span><span class="dv">2</span>, <span class="op">:</span>A<span class="op">={.</span>a<span class="op">=</span><span class="dv">1</span><span class="op">}}</span></code> is ill-formed (out of order), as is <code class="sourceCode cpp">B<span class="op">{</span>{.a=1}, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span></code> (some designated but not all).</p>
<p>This generalizes to more complex aggregates like:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span> <span class="kw">struct</span> C <span class="op">{</span> T val; <span class="op">}</span>;</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">struct</span> D <span class="op">:</span> C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span>, C<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;</span> <span class="op">{</span> <span class="op">}</span>;</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>D<span class="op">{:</span>C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;={.</span>val<span class="op">=</span><span class="dv">1</span><span class="op">}</span>, <span class="op">:</span>C<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;={.</span>val<span class="op">=</span><span class="ch">&#39;x&#39;</span><span class="op">}}</span>;</span></code></pre></div>
<p>Which provides protection against <code class="sourceCode cpp">D<span class="op">{</span><span class="ch">&#39;x&#39;</span>, <span class="dv">1</span><span class="op">}</span></code> which compiles fine today but probably isn’t what was desired.</p>
<h2 data-number="3.1" id="directly-name-base-class-members"><span class="header-section-number">3.1</span> Directly name base-class members<a href="#directly-name-base-class-members" class="self-link"></a></h2>
<p>In most use-cases, while an aggregate may have base classes (which may themselves have further base classes), all the names of all the members all the way down will be distinct. The initial example here is just such a case: <code class="sourceCode cpp">B</code> has two members, <code class="sourceCode cpp">a</code> and <code class="sourceCode cpp">b</code>. We already have brace elision, which allows for <code class="sourceCode cpp">B<span class="op">{</span><span class="dv">1</span>, <span class="dv">2</span><span class="op">}</span></code>. But the designated initializer model is a lot safer: you have to name the members, so you can’t really do the wrong thing. So it seems like a logic extension to support <code class="sourceCode cpp">B<span class="op">{.</span>a<span class="op">=</span><span class="dv">1</span>, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span></code>.</p>
<p>We still preserve all the rules around designated initializers: members need to be named <em>in order</em>. It’s just that we remove the restriction that all the members have to be direct members of the class we’re initializing.</p>
<p>That is:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1"></a>B<span class="op">{:</span>A<span class="op">={.</span>a<span class="op">=</span><span class="dv">1</span><span class="op">}</span>, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span>;      <span class="co">// fully explicit</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>B<span class="op">{:</span>A<span class="op">={</span><span class="dv">1</span><span class="op">}</span>, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span>;         <span class="co">// ok</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>B<span class="op">{.</span>a<span class="op">=</span><span class="dv">1</span>, <span class="op">.</span>b<span class="op">=</span><span class="dv">2</span><span class="op">}</span>;           <span class="co">// ok</span></span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>B<span class="op">{.</span>b<span class="op">=</span><span class="dv">2</span>, <span class="op">.</span>a<span class="op">=</span><span class="dv">1</span><span class="op">}</span>;           <span class="co">// error: out of order</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>B<span class="op">{.</span>b<span class="op">=</span><span class="dv">2</span>, <span class="op">:</span>A<span class="op">{</span><span class="dv">1</span><span class="op">}}</span>;          <span class="co">// error: out of order</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>B<span class="op">{:</span>A<span class="op">{.</span>a<span class="op">=</span><span class="dv">1</span><span class="op">}</span>, <span class="op">.</span>a<span class="op">=</span><span class="dv">2</span>, <span class="op">.</span>b<span class="op">=</span><span class="dv">3</span><span class="op">}</span>; <span class="co">// error: both A and a are named</span></span></code></pre></div>
<p>The last row there has to be ill-formed. If an indirect member is named, you can’t also name any class that contains it. But there’s also another issue to consider here:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">class</span> string <span class="op">{</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="dt">char</span><span class="op">*</span> begin;</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="dt">char</span><span class="op">*</span> end;</span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="dt">char</span><span class="op">*</span> capacity;</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">public</span><span class="op">:</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    string<span class="op">()</span>;</span>
<span id="cb5-7"><a href="#cb5-7"></a>    string<span class="op">(</span><span class="dt">char</span> <span class="kw">const</span><span class="op">*)</span>;</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="op">}</span>;</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="kw">struct</span> D <span class="op">:</span> string <span class="op">{</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="dt">int</span> index;</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="op">}</span>;</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a>D<span class="op">{</span><span class="st">&quot;hello&quot;</span>, <span class="dv">42</span><span class="op">}</span>;                 <span class="co">// already ok</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>D<span class="op">{:</span>string<span class="op">(</span><span class="st">&quot;hello&quot;</span><span class="op">)</span>, <span class="op">.</span>index<span class="op">=</span><span class="dv">42</span><span class="op">}</span>; <span class="co">// ok</span></span>
<span id="cb5-16"><a href="#cb5-16"></a></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="dt">char</span> storage<span class="op">[</span><span class="dv">10</span><span class="op">]</span>;</span>
<span id="cb5-18"><a href="#cb5-18"></a>D<span class="op">{.</span>begin<span class="op">=</span>storage, <span class="op">.</span>end<span class="op">=</span>storage, <span class="op">.</span>capacity<span class="op">=</span>storage<span class="op">+</span><span class="dv">10</span>, <span class="op">.</span>index<span class="op">=</span><span class="dv">17</span><span class="op">}</span>; <span class="co">// definitely error</span></span></code></pre></div>
<p>This obviously has to be an error. <code class="sourceCode cpp">string</code> isn’t an aggregate, so this feature can’t give us magic aggregate-initialization powers. So the rule for naming indirect members has to be both that:</p>
<ol type="1">
<li>the indirect member is not a (direct or indirect) member of any base class also named in the designated-initializer-list, and</li>
<li>the indirect member is not a (direct or indirect) member of any base class that is not an aggregate.</li>
</ol>
<h2 data-number="3.2" id="lookup-of-base-classes"><span class="header-section-number">3.2</span> Lookup of base classes<a href="#lookup-of-base-classes" class="self-link"></a></h2>
<p>One other thing we need to consider is how we look up base classes exactly. With regular designated initializers, they’re just the names of direct members and there’s only one way to name them. Not much to talk about. But with base classes, we have an <em>injected-class-name</em> too, so we have to ask the question:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span> <span class="kw">struct</span> C <span class="op">{</span> T val; <span class="op">}</span>;</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">struct</span> D <span class="op">:</span> C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> <span class="op">{</span> <span class="op">}</span>;</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a>D<span class="op">{:</span>C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;{.</span>val<span class="op">=</span><span class="dv">0</span><span class="op">}}</span>; <span class="co">// proposed okay, C&lt;int&gt; is a base class</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>D<span class="op">{:</span>C<span class="op">{.</span>val<span class="op">=</span><span class="dv">1</span><span class="op">}}</span>;      <span class="co">// how about this?</span></span></code></pre></div>
<p>From within the scope of <code class="sourceCode cpp">D</code>, we can use <code class="sourceCode cpp">C</code> to identify the base class <code class="sourceCode cpp">C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span></code>. Likewise <code class="sourceCode cpp">D<span class="op">::</span>C</code> names that type. Can we do this externally? Designated initializers already sort of look like they’re from within the class. This seems like it should probably apply to base classes as well.</p>
<p>But in order for <code class="sourceCode cpp"><span class="op">:</span>C</code> to find <code class="sourceCode cpp">D<span class="op">::</span>C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;::</span>C</code> there, we’d have to say that lookup is in the context of the body of <code class="sourceCode cpp">D</code>. But then what if we have:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">namespace</span> N <span class="op">{</span> <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span> <span class="kw">struct</span> C <span class="op">{</span> <span class="op">}</span>; <span class="op">}</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">struct</span> D <span class="op">:</span> N<span class="op">::</span>C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> <span class="op">{</span> <span class="op">}</span>;</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">using</span> C <span class="op">=</span> N<span class="op">::</span>C<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span>;</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a>D<span class="op">{:</span>C<span class="op">{}}</span>;</span></code></pre></div>
<p>Does <code class="sourceCode cpp"><span class="op">:</span>C</code> refer to the <em>injected-class-name</em> of the <code class="sourceCode cpp">C<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span></code> base class of <code class="sourceCode cpp">D</code> (and thus be well-formed), or does <code class="sourceCode cpp"><span class="op">:</span>C</code> refer to the alias <code class="sourceCode cpp">C</code> (and thus be ill-formed, since <code class="sourceCode cpp">N<span class="op">::</span>C<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span></code> is not a base class of <code class="sourceCode cpp">D</code>)? Arguably, we are initializing a <code class="sourceCode cpp">D</code> so looking up from the context of <code class="sourceCode cpp">D</code> is a sensible rule (and is consistent with the rules we have for <code class="sourceCode cpp">x<span class="op">.</span><span class="kw">operator</span> T<span class="op">()</span></code> looking up <code class="sourceCode cpp">T</code> in the context of <code class="sourceCode cpp">x</code> <span>6.5.3
 <a href="https://wg21.link/basic.lookup.unqual">[basic.lookup.unqual]</a></span>/5).</p>
<p>We just need to make sure that we don’t do that kind of lookup for a <em>decltype-specifier</em> as a base class, since that probably makes very little sense to consider from the class’ context.</p>
<h1 data-number="4" style="border-bottom:1px solid #cccccc" id="wording"><span class="header-section-number">4</span> Wording<a href="#wording" class="self-link"></a></h1>
<p>Add a rule for looking up unqualified names used in designators in <span>6.5.3
 <a href="https://wg21.link/basic.lookup.unqual">[basic.lookup.unqual]</a></span>:</p>
<blockquote>
<p><span class="marginalizedparent"><a class="marginalized">5</a></span> An unqualified name that is a component name ([expr.prim.id.unqual]) of a <em>type-specifier</em> or <em>ptr-operator</em> of a <em>conversion-type-id</em> is looked up in the same fashion as the <em>conversion-function-id</em> in which it appears. If that lookup finds nothing, it undergoes unqualified name lookup; in each case, only names that denote types or templates whose specializations are types are considered.</p>
<div class="addu">
<p><span class="marginalizedparent"><a class="marginalized">*</a></span> An unqualified name that appears as the <em>class-or-decltype</em> in a <em>designator</em> in a <em>designated-initializer-list</em> ([dcl.init.general]) is looked up in the same fashion as if it were a <em>conversion-function-id</em> in the same context. If that lookup finds nothing, it undergoes unqualified name lookup; in each case, only names that denote types or templates whose specializations are types are considered.</p>
<p>[<em>Example</em>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb8-1"><a href="#cb8-1"></a>namespace N {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  struct A { int a; };</span>
<span id="cb8-3"><a href="#cb8-3"></a>  template &lt;typename T&gt; struct B : T { int b; };</span>
<span id="cb8-4"><a href="#cb8-4"></a>}</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a>using C = N::A;</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a>N::B&lt;A&gt;{:A{.a=1}, .b=2}; // ok, lookup for A in N::B&lt;A&gt; finds the injected-class-name A</span>
<span id="cb8-9"><a href="#cb8-9"></a>N::B&lt;A&gt;{:C{.a=1}, .b=2}; // ok, lookup for A in N::B&lt;A&gt; finds nothing, regular unqualified lookup finds C</span></code></pre></div>
<p><em>-end example</em>]</p>
</div>
</blockquote>
<p>Change the grammar of a <em>designator</em> in <span>9.4.1
 <a href="https://wg21.link/dcl.init.general">[dcl.init.general]</a></span>/1. Technically this allows a <em>designated-initializer-list</em> like <code class="sourceCode cpp"><span class="op">{.</span>a<span class="op">=</span><span class="dv">1</span>, <span class="op">:</span>A<span class="op">={}}</span></code> which we could forbid grammatically, but that seems more complicated than simply extending the ordering rule to forbid it (which has to be done anyway).</p>
<blockquote>
<div>
<div class="sourceCode" id="cb9"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb9-1"><a href="#cb9-1"></a>  <em>designator</em>:</span>
<span id="cb9-2"><a href="#cb9-2"></a>      . <em>identifier</em></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="va">+     : <em>class-or-decltype</em></span></span></code></pre></div>
</div>
</blockquote>
<p>Extend <span>9.4.1
 <a href="https://wg21.link/dcl.init.general">[dcl.init.general]</a></span>/18:</p>
<blockquote>
<p><span class="marginalizedparent"><a class="marginalized">18</a></span> The same <em>identifier</em> shall not appear in multiple designators of a <em>designated-initializer-list</em>. <span class="addu">The same <em>class-or-decltype</em> shall not appear in multiple designators of a <em>designated-initializer-list</em>.</span></p>
</blockquote>
<p>Extend <span>9.4.2
 <a href="https://wg21.link/dcl.init.aggr">[dcl.init.aggr]</a></span>/3.1:</p>
<blockquote>
<p><span class="marginalizedparent"><a class="marginalized">(3.1)</a></span> If the initializer list is a <em>designated-initializer-list</em>, the aggregate shall be of class type, the <em>identifier</em> in each designator shall name a <span class="rm" style="color: #bf0303"><del>direct</del></span> non-static data member of the class, <span class="addu">the <em>class-or-decltype</em> in each designator shall name a base class of the class,</span> and the explicitly initialized elements of the aggregate are the elements that are, or contain, those members. <span class="addu">If any <em>identifier</em> in a designator names a (direct or indirect) non-static data member of a base class that is either named by a <em>class-or-decltype</em> in a different designator or that is not an aggregate, the initialization is ill-formed.</span></p>
</blockquote>
<p>Extend <span>9.4.5
 <a href="https://wg21.link/dcl.init.list">[dcl.init.list]</a></span>/3.1:</p>
<blockquote>
<p><span class="marginalizedparent"><a class="marginalized">(3.1)</a></span> If the <em>braced-init-list</em> contains a <em>designated-initializer-list</em>, <code class="sourceCode cpp">T</code> shall be an aggregate class. The ordered <span class="addu"><em>class-or-decltype</em>s and</span> <em>identifier</em>s in the designators of the <em>designated-initializer-list</em> shall form a subsequence of the ordered <span class="addu">base classes of <code class="sourceCode cpp">T</code> and</span> <em>identifier</em>s in the <span class="rm" style="color: #bf0303"><del>direct</del></span> non-static data members of <code class="sourceCode cpp">T</code>. Aggregate initialization is performed ([dcl.init.aggr]). [<em>Example 2</em>:</p>
<div>
<div class="sourceCode" id="cb10"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb10-1"><a href="#cb10-1"></a>  struct A { int x; int y; int z; };</span>
<span id="cb10-2"><a href="#cb10-2"></a>  A a{.y = 2, .x = 1};                // error: designator order does not match declaration order</span>
<span id="cb10-3"><a href="#cb10-3"></a>  A b{.x = 1, .z = 2};                // OK, b.y initialized to 0</span>
<span id="cb10-4"><a href="#cb10-4"></a>  </span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="va">+ struct B : A { int q; };</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="va">+ B c{.q = 3, :A{}};                  // error: designator order does not match declaration order</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="va">+ B d{:A{}, .q = 3};                  // OK, d.x, d.y, and d.z all initialized to 0</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="va">+ B e{.x = 1, .q = 3};                // OK, e.y and e.z initialized to 0</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="va">+ B f{:A{}, .x = 1, .q = 3};          // error: x is a member of A, which also appears in the designated-initializer-list</span></span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="va">+ struct NonAggr { int na; NonAggr(int); };</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="va">+ struct D : NonAggr { int d; };</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="va">+ D g{:NonAggr{1}, .d=2};             // OK</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="va">+ D h{.na=1, .d=2};                   // error: na is a member of a class that is not an aggregate</span></span></code></pre></div>
</div>
<p>— <em>end example</em>]</p>
</blockquote>
<h1 data-number="5" style="border-bottom:1px solid #cccccc" id="bibliography"><span class="header-section-number">5</span> References<a href="#bibliography" class="self-link"></a></h1>
<div id="refs" class="references hanging-indent" role="doc-bibliography">
<div id="ref-P0017R1">
<p>[P0017R1] Oleg Smolsky. 2015-10-24. Extension to aggregate initialization. <br />
<a href="https://wg21.link/p0017r1">https://wg21.link/p0017r1</a></p>
</div>
<div id="ref-P0329R4">
<p>[P0329R4] Tim Shen, Richard Smith. 2017-07-12. Designated Initialization Wording. <br />
<a href="https://wg21.link/p0329r4">https://wg21.link/p0329r4</a></p>
</div>
<div id="ref-P2287R0">
<p>[P2287R0] Barry Revzin. 2021-01-21. Designated-initializers for base classes. <br />
<a href="https://wg21.link/p2287r0">https://wg21.link/p2287r0</a></p>
</div>
</div>
</div>
</div>
</body>
</html>
